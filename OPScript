local Fluent = loadstring(game:HttpGet("https://github.com/dawid-scripts/Fluent/releases/latest/download/main.lua"))()

local CurrentVersion = "Infinite Mining Incremental v1"

local Window = Fluent:CreateWindow({
    Title = CurrentVersion,
    SubTitle = "by ngw12345",
    TabWidth = 160,
    Size = UDim2.fromOffset(580, 460),
    Acrylic = true, -- The blur may be detectable, setting this to false disables blur entirely
    Theme = "Darker",
    MinimizeKey = Enum.KeyCode.LeftControl -- Used when theres no MinimizeKeybind
})

-- Local Var List

-- Fluent provides Lucide Icons, they are optional
local Tabs = {
    Teleports = Window:AddTab({ Title = "Teleports", Icon = "rocket" }),
    AutoFarm = Window:AddTab({ Title = "Automation", Icon = "crown" }),
    Settings = Window:AddTab({ Title = "Settings", Icon = "settings" })
}

local SaveManager = loadstring(game:HttpGet("https://raw.githubusercontent.com/dawid-scripts/Fluent/master/Addons/SaveManager.lua"))()
local InterfaceManager = loadstring(game:HttpGet("https://raw.githubusercontent.com/dawid-scripts/Fluent/master/Addons/InterfaceManager.lua"))()

SaveManager:SetLibrary(Fluent)
InterfaceManager:SetLibrary(Fluent)

InterfaceManager:BuildInterfaceSection(Tabs.Settings)
SaveManager:BuildConfigSection(Tabs.Settings)

Window:SelectTab(1)

local Toggle = Tabs.AutoFarm:AddToggle("AutoFarmToggle", 
{
    Title = "Auto Farm (Manual Remote)",
    Description = "Auto swings using manual remote firing with pulsing hitbox",
    Default = false,
    Callback = function(state)
        if state then
            print("AutoFarm On")
            getgenv().AutoFarmRunning = true

            task.spawn(function()
                local Players = game:GetService("Players")
                local player = Players.LocalPlayer
                local remote = game:GetService("ReplicatedStorage"):WaitForChild("RemoteEvents"):WaitForChild("WeaponSwingEvent")

                local hitbox

                -- Try to locate the Hitbox part dynamically
                local function findHitbox()
                    local charFolder = workspace:FindFirstChild(player.Name)
                    if charFolder then
                        local children = charFolder:GetChildren()
                        if #children > 0 then
                            local last = children[#children]
                            hitbox = last:FindFirstChild("Hitbox")
                        end
                    end
                end

                findHitbox()

                while getgenv().AutoFarmRunning do
                    if not hitbox or not hitbox:IsDescendantOf(workspace) then
                        findHitbox()
                    end

                    if hitbox and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                        local hrp = player.Character.HumanoidRootPart
                        hitbox.Anchored = true
                        hitbox.CanCollide = false

                        -- Fire swing events
                        remote:FireServer("SwingStart")
                        remote:FireServer("HitboxStart")

                        -- Pulse the hitbox size in a loop for 1 second (or however long swing lasts)
                        local swingDuration = 10 -- change this if needed
                        local swingStart = tick()

                        while tick() - swingStart < swingDuration do
                            hitbox.CFrame = hrp.CFrame * CFrame.new(0, 0, -10)

                            hitbox.Size = Vector3.new(1, 1, 1)
                            task.wait(0.05)

                            hitbox.Size = Vector3.new(15, 15, 15)
                            task.wait(0.05)

                            hitbox.Size = Vector3.new(25, 25, 25)
                            task.wait(0.05)
                        end

                        remote:FireServer("HitboxEnd")
                        remote:FireServer("SwingEnd")
                    end

                    task.wait(0.15) -- Delay between swings
                end
            end)
        else
            print("AutoFarm Off")
            getgenv().AutoFarmRunning = false
        end
    end 
})
